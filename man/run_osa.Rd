% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/run_osa.R
\name{run_osa}
\alias{run_osa}
\title{Run OSA residuals}
\usage{
run_osa(obs, exp, Neff, fleet, index, years, index_label = "Age or Length")
}
\arguments{
\item{obs}{matrix of observed ages or lengths (nrow=years, ncol=index of age
or length bin)}

\item{exp}{matrix of predicted/expected ages or lengths (same dimension as
obs)}

\item{Neff}{matrix of assumed effective sample sizes (same dimension as obs)}

\item{fleet}{character name for fishery or survey fleet, could also identify
sex}

\item{index}{vector giving the index of ages or length bins}

\item{years}{vector of years associated with the observed ages or lengths}

\item{index_label}{character value indicating 'age' or 'length bin' depending
on comp type}
}
\value{
a list with two elements: (1) res: a long-format dataframe with
  columns fleet, index_label (indicates whether the comp is age or length),
  year, index (age or length bin), resid (osa), and (2) agg: a dataframe of
  aggregated fits of the composition data with columns fleet, index_label,
  index, obs, and exp
}
\description{
Run OSA residuals
}
\examples{
# GOA pollock info
repfile <- afscOSA::goapkrep
datfile <- afscOSA::goapkdat

# ages and years for age comp data
ages <- 3:10
yrs <- datfile$srv_acyrs1
# observed age comps
myobs <- repfile$Survey_1_observed_and_expected_age_comp[ ,ages]
# predicted age comps from assessment model
myexp <- repfile$Survey_1_observed_and_expected_age_comp[ ,10+ages]
# assumed effective sample sizes
myNeff <- datfile$multN_srv1 # this gets rounded
#
myfleet='Survey1'
run_osa(obs = myobs, exp = myexp, Neff = myNeff, index = ages, years = yrs, index_label = 'Age')

}
